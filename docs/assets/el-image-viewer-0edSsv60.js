import{k as y,g as _e,h as ie,ak as ve,r as z,al as xe,s as Ce,d as ce,n as ye,o as he,m as C,B as de,G as m,C as O,y as a,x as I,J as fe,H as Se,A as x,q as A,F as se,p as M,D as Te,v as ze,l as Ne,Y as Oe,z as ae,T as Ae,Q as Re,u as $e,E as Be,f as Me,I as Ve}from"./index-Xc3Yzc2G.js";import{m as we,u as K,E as H}from"./typescript-ml7cVkNB.js";import{i as j,j as De,A as Pe,d as ke,e as me,c as re,G as We,H as Fe,u as be,E as V,o as Xe,I as Ye,J as He,K as je,L as Ke,M as Ze,N as Ue,_ as Ie,w as Ee,O as Ge,D as qe}from"./base-9Z_h2vHL.js";import{i as Je,b as oe,r as Qe,u as Le,a as et,k as tt}from"./index-7MvDZnRv.js";import{a as nt}from"./scroll-ZjKFmqgD.js";import{I as at}from"./IconPark-ggFK5aku.js";const st=(e,o)=>{if(!j||!e||!o)return!1;const s=e.getBoundingClientRect();let r;return o instanceof Element?r=o.getBoundingClientRect():r={top:0,right:window.innerWidth,bottom:window.innerHeight,left:0},s.top<r.bottom&&s.bottom>r.top&&s.right>r.left&&s.left<r.right};var rt=/\s/;function ot(e){for(var o=e.length;o--&&rt.test(e.charAt(o)););return o}var it=/^\s+/;function lt(e){return e&&e.slice(0,ot(e)+1).replace(it,"")}var ge=NaN,ut=/^[-+]0x[0-9a-f]+$/i,ct=/^0b[01]+$/i,dt=/^0o[0-7]+$/i,ft=parseInt;function pe(e){if(typeof e=="number")return e;if(Je(e))return ge;if(oe(e)){var o=typeof e.valueOf=="function"?e.valueOf():e;e=oe(o)?o+"":o}if(typeof e!="string")return e===0?e:+e;e=lt(e);var s=ct.test(e);return s||dt.test(e)?ft(e.slice(2),s?2:8):ut.test(e)?ge:+e}var mt=function(){return Qe.Date.now()};const le=mt;var vt="Expected a function",gt=Math.max,pt=Math.min;function yt(e,o,s){var r,d,v,l,h,b,E=0,_=!1,w=!1,g=!0;if(typeof e!="function")throw new TypeError(vt);o=pe(o)||0,oe(s)&&(_=!!s.leading,w="maxWait"in s,v=w?gt(pe(s.maxWait)||0,o):v,g="trailing"in s?!!s.trailing:g);function p(u){var k=r,B=d;return r=d=void 0,E=u,l=e.apply(B,k),l}function c(u){return E=u,h=setTimeout($,o),_?p(u):l}function D(u){var k=u-b,B=u-E,X=o-k;return w?pt(X,v-B):X}function R(u){var k=u-b,B=u-E;return b===void 0||k>=o||k<0||w&&B>=v}function $(){var u=le();if(R(u))return F(u);h=setTimeout($,D(u))}function F(u){return h=void 0,g&&r?p(u):(r=d=void 0,l)}function Z(){h!==void 0&&clearTimeout(h),E=0,r=b=d=h=void 0}function P(){return h===void 0?l:F(le())}function W(){var u=le(),k=R(u);if(r=arguments,d=this,b=u,k){if(h===void 0)return c(b);if(w)return clearTimeout(h),h=setTimeout($,o),p(b)}return h===void 0&&(h=setTimeout($,o)),l}return W.cancel=Z,W.flush=P,W}var ht="Expected a function";function ue(e,o,s){var r=!0,d=!0;if(typeof e!="function")throw new TypeError(ht);return oe(s)&&(r="leading"in s?!!s.leading:r,d="trailing"in s?!!s.trailing:d),yt(e,o,{leading:r,maxWait:o,trailing:d})}const wt=["class","style"],kt=/^on[A-Z]/,bt=(e={})=>{const{excludeListeners:o=!1,excludeKeys:s}=e,r=y(()=>((s==null?void 0:s.value)||[]).concat(wt)),d=_e();return d?y(()=>{var v;return Pe(Object.entries((v=d.proxy)==null?void 0:v.$attrs).filter(([l])=>!r.value.includes(l)&&!(o&&kt.test(l))))}):(De("use-attrs","getCurrentInstance() returned null. useAttrs() must be called at the top of a setup function"),y(()=>({})))},It=ke({urlList:{type:me(Array),default:()=>we([])},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:Boolean,teleported:Boolean,closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7}}),Et={close:()=>!0,switch:e=>re(e),rotate:e=>re(e)},Lt=["src"],_t=ie({name:"ElImageViewer"}),xt=ie({..._t,props:It,emits:Et,setup(e,{expose:o,emit:s}){const r=e,d={CONTAIN:{name:"contain",icon:ve(We)},ORIGINAL:{name:"original",icon:ve(Fe)}},{t:v}=Le(),l=be("image-viewer"),{nextZIndex:h}=et(),b=z(),E=z([]),_=xe(),w=z(!0),g=z(r.initialIndex),p=Ce(d.CONTAIN),c=z({scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),D=y(()=>{const{urlList:n}=r;return n.length<=1}),R=y(()=>g.value===0),$=y(()=>g.value===r.urlList.length-1),F=y(()=>r.urlList[g.value]),Z=y(()=>[l.e("btn"),l.e("prev"),l.is("disabled",!r.infinite&&R.value)]),P=y(()=>[l.e("btn"),l.e("next"),l.is("disabled",!r.infinite&&$.value)]),W=y(()=>{const{scale:n,deg:i,offsetX:f,offsetY:S,enableTransition:N}=c.value;let L=f/n,T=S/n;switch(i%360){case 90:case-270:[L,T]=[T,-L];break;case 180:case-180:[L,T]=[-L,-T];break;case 270:case-90:[L,T]=[-T,L];break}const Y={transform:`scale(${n}) rotate(${i}deg) translate(${L}px, ${T}px)`,transition:N?"transform .3s":""};return p.value.name===d.CONTAIN.name&&(Y.maxWidth=Y.maxHeight="100%"),Y}),u=y(()=>re(r.zIndex)?r.zIndex:h());function k(){X(),s("close")}function B(){const n=ue(f=>{switch(f.code){case H.esc:r.closeOnPressEscape&&k();break;case H.space:ee();break;case H.left:te();break;case H.up:t("zoomIn");break;case H.right:ne();break;case H.down:t("zoomOut");break}}),i=ue(f=>{const S=f.deltaY||f.deltaX;t(S<0?"zoomIn":"zoomOut",{zoomRate:r.zoomRate,enableTransition:!1})});_.run(()=>{K(document,"keydown",n),K(document,"wheel",i)})}function X(){_.stop()}function q(){w.value=!1}function J(n){w.value=!1,n.target.alt=v("el.image.error")}function Q(n){if(w.value||n.button!==0||!b.value)return;c.value.enableTransition=!1;const{offsetX:i,offsetY:f}=c.value,S=n.pageX,N=n.pageY,L=ue(Y=>{c.value={...c.value,offsetX:i+Y.pageX-S,offsetY:f+Y.pageY-N}}),T=K(document,"mousemove",L);K(document,"mouseup",()=>{T()}),n.preventDefault()}function U(){c.value={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function ee(){if(w.value)return;const n=tt(d),i=Object.values(d),f=p.value.name,N=(i.findIndex(L=>L.name===f)+1)%n.length;p.value=d[n[N]],U()}function G(n){const i=r.urlList.length;g.value=(n+i)%i}function te(){R.value&&!r.infinite||G(g.value-1)}function ne(){$.value&&!r.infinite||G(g.value+1)}function t(n,i={}){if(w.value)return;const{minScale:f,maxScale:S}=r,{zoomRate:N,rotateDeg:L,enableTransition:T}={zoomRate:r.zoomRate,rotateDeg:90,enableTransition:!0,...i};switch(n){case"zoomOut":c.value.scale>f&&(c.value.scale=Number.parseFloat((c.value.scale/N).toFixed(3)));break;case"zoomIn":c.value.scale<S&&(c.value.scale=Number.parseFloat((c.value.scale*N).toFixed(3)));break;case"clockwise":c.value.deg+=L,s("rotate",c.value.deg);break;case"anticlockwise":c.value.deg-=L,s("rotate",c.value.deg);break}c.value.enableTransition=T}return ce(F,()=>{ye(()=>{const n=E.value[0];n!=null&&n.complete||(w.value=!0)})}),ce(g,n=>{U(),s("switch",n)}),he(()=>{var n,i;B(),(i=(n=b.value)==null?void 0:n.focus)==null||i.call(n)}),o({setActiveItem:G}),(n,i)=>(C(),de(Re,{to:"body",disabled:!n.teleported},[m(Ae,{name:"viewer-fade",appear:""},{default:O(()=>[x("div",{ref_key:"wrapper",ref:b,tabindex:-1,class:I(a(l).e("wrapper")),style:fe({zIndex:a(u)})},[x("div",{class:I(a(l).e("mask")),onClick:i[0]||(i[0]=Se(f=>n.hideOnClickModal&&k(),["self"]))},null,2),A(" CLOSE "),x("span",{class:I([a(l).e("btn"),a(l).e("close")]),onClick:k},[m(a(V),null,{default:O(()=>[m(a(Xe))]),_:1})],2),A(" ARROW "),a(D)?A("v-if",!0):(C(),M(se,{key:0},[x("span",{class:I(a(Z)),onClick:te},[m(a(V),null,{default:O(()=>[m(a(Ye))]),_:1})],2),x("span",{class:I(a(P)),onClick:ne},[m(a(V),null,{default:O(()=>[m(a(He))]),_:1})],2)],64)),A(" ACTIONS "),x("div",{class:I([a(l).e("btn"),a(l).e("actions")])},[x("div",{class:I(a(l).e("actions__inner"))},[m(a(V),{onClick:i[1]||(i[1]=f=>t("zoomOut"))},{default:O(()=>[m(a(je))]),_:1}),m(a(V),{onClick:i[2]||(i[2]=f=>t("zoomIn"))},{default:O(()=>[m(a(Ke))]),_:1}),x("i",{class:I(a(l).e("actions__divider"))},null,2),m(a(V),{onClick:ee},{default:O(()=>[(C(),de(Te(a(p).icon)))]),_:1}),x("i",{class:I(a(l).e("actions__divider"))},null,2),m(a(V),{onClick:i[3]||(i[3]=f=>t("anticlockwise"))},{default:O(()=>[m(a(Ze))]),_:1}),m(a(V),{onClick:i[4]||(i[4]=f=>t("clockwise"))},{default:O(()=>[m(a(Ue))]),_:1})],2)],2),A(" CANVAS "),x("div",{class:I(a(l).e("canvas"))},[(C(!0),M(se,null,Oe(n.urlList,(f,S)=>Ne((C(),M("img",{ref_for:!0,ref:N=>E.value[S]=N,key:f,src:f,style:fe(a(W)),class:I(a(l).e("img")),onLoad:q,onError:J,onMousedown:Q},null,46,Lt)),[[ze,S===g.value]])),128))],2),ae(n.$slots,"default")],6)]),_:3})],8,["disabled"]))}});var Ct=Ie(xt,[["__file","image-viewer.vue"]]);const St=Ee(Ct),Tt=ke({hideOnClickModal:Boolean,src:{type:String,default:""},fit:{type:String,values:["","contain","cover","fill","none","scale-down"],default:""},loading:{type:String,values:["eager","lazy"]},lazy:Boolean,scrollContainer:{type:me([String,Object])},previewSrcList:{type:me(Array),default:()=>we([])},previewTeleported:Boolean,zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7}}),zt={load:e=>e instanceof Event,error:e=>e instanceof Event,switch:e=>re(e),close:()=>!0,show:()=>!0},Nt=["src","loading"],Ot={key:0},At=ie({name:"ElImage",inheritAttrs:!1}),Rt=ie({...At,props:Tt,emits:zt,setup(e,{emit:o}){const s=e;let r="";const{t:d}=Le(),v=be("image"),l=$e(),h=bt(),b=z(),E=z(!1),_=z(!0),w=z(!1),g=z(),p=z(),c=j&&"loading"in HTMLImageElement.prototype;let D,R;const $=y(()=>[v.e("inner"),P.value&&v.e("preview"),_.value&&v.is("loading")]),F=y(()=>l.style),Z=y(()=>{const{fit:t}=s;return j&&t?{objectFit:t}:{}}),P=y(()=>{const{previewSrcList:t}=s;return Array.isArray(t)&&t.length>0}),W=y(()=>{const{previewSrcList:t,initialIndex:n}=s;let i=n;return n>t.length-1&&(i=0),i}),u=y(()=>s.loading==="eager"?!1:!c&&s.loading==="lazy"||s.lazy),k=()=>{j&&(_.value=!0,E.value=!1,b.value=s.src)};function B(t){_.value=!1,E.value=!1,o("load",t)}function X(t){_.value=!1,E.value=!0,o("error",t)}function q(){st(g.value,p.value)&&(k(),U())}const J=Ge(q,200,!0);async function Q(){var t;if(!j)return;await ye();const{scrollContainer:n}=s;qe(n)?p.value=n:Me(n)&&n!==""?p.value=(t=document.querySelector(n))!=null?t:void 0:g.value&&(p.value=nt(g.value)),p.value&&(D=K(p,"scroll",J),setTimeout(()=>q(),100))}function U(){!j||!p.value||!J||(D==null||D(),p.value=void 0)}function ee(t){if(t.ctrlKey){if(t.deltaY<0)return t.preventDefault(),!1;if(t.deltaY>0)return t.preventDefault(),!1}}function G(){P.value&&(R=K("wheel",ee,{passive:!1}),r=document.body.style.overflow,document.body.style.overflow="hidden",w.value=!0,o("show"))}function te(){R==null||R(),document.body.style.overflow=r,w.value=!1,o("close")}function ne(t){o("switch",t)}return ce(()=>s.src,()=>{u.value?(_.value=!0,E.value=!1,U(),Q()):k()}),he(()=>{u.value?Q():k()}),(t,n)=>(C(),M("div",{ref_key:"container",ref:g,class:I([a(v).b(),t.$attrs.class]),style:fe(a(F))},[E.value?ae(t.$slots,"error",{key:0},()=>[x("div",{class:I(a(v).e("error"))},Ve(a(d)("el.image.error")),3)]):(C(),M(se,{key:1},[b.value!==void 0?(C(),M("img",Be({key:0},a(h),{src:b.value,loading:t.loading,style:a(Z),class:a($),onClick:G,onLoad:B,onError:X}),null,16,Nt)):A("v-if",!0),_.value?(C(),M("div",{key:1,class:I(a(v).e("wrapper"))},[ae(t.$slots,"placeholder",{},()=>[x("div",{class:I(a(v).e("placeholder"))},null,2)])],2)):A("v-if",!0)],64)),a(P)?(C(),M(se,{key:2},[w.value?(C(),de(a(St),{key:0,"z-index":t.zIndex,"initial-index":a(W),infinite:t.infinite,"zoom-rate":t.zoomRate,"min-scale":t.minScale,"max-scale":t.maxScale,"url-list":t.previewSrcList,"hide-on-click-modal":t.hideOnClickModal,teleported:t.previewTeleported,"close-on-press-escape":t.closeOnPressEscape,onClose:te,onSwitch:ne},{default:O(()=>[t.$slots.viewer?(C(),M("div",Ot,[ae(t.$slots,"viewer")])):A("v-if",!0)]),_:3},8,["z-index","initial-index","infinite","zoom-rate","min-scale","max-scale","url-list","hide-on-click-modal","teleported","close-on-press-escape"])):A("v-if",!0)],64)):A("v-if",!0)],6))}});var $t=Ie(Rt,[["__file","image.vue"]]);const Ft=Ee($t),Xt=at("play",!0,function(e){return m("svg",{width:e.size,height:e.size,viewBox:"0 0 48 48",fill:"none"},[m("path",{d:"M24 44C35.0457 44 44 35.0457 44 24C44 12.9543 35.0457 4 24 4C12.9543 4 4 12.9543 4 24C4 35.0457 12.9543 44 24 44Z",fill:e.colors[1],stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linejoin":e.strokeLinejoin},null),m("path",{d:"M20 24V17.0718L26 20.5359L32 24L26 27.4641L20 30.9282V24Z",fill:e.colors[3],stroke:e.colors[2],"stroke-width":e.strokeWidth,"stroke-linejoin":e.strokeLinejoin},null)])});export{Ft as E,Xt as P,yt as d,bt as u};
